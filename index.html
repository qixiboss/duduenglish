<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>英语学习助手</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1a73e8',
                        secondary: '#4285f4',
                        success: '#34a853',
                        danger: '#ea4335',
                        neutral: '#f8f9fa',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .card-shadow {
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            }
            .option-hover {
                transition: all 0.2s ease-in-out;
            }
            .option-hover:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(26, 115, 232, 0.15);
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-6">
            <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-primary flex items-center justify-center">
                <i class="fa fa-graduation-cap mr-3"></i>英语学习助手
            </h1>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- 功能卡片网格 -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- 单词翻译挑战卡片 -->
                <div class="bg-white rounded-xl card-shadow p-6 transform transition-all duration-300 hover:shadow-lg flex flex-col h-full">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-book text-primary text-xl"></i>
                        </div>
                        <h2 class="text-xl font-semibold text-gray-800">单词翻译挑战</h2>
                    </div>
                    <p class="text-gray-600 flex-grow">通过选择题的形式测试你对单词的理解，支持自定义单词库。</p>
                    <a href="englishdudu.html" class="block w-full bg-primary text-white text-center rounded-lg px-6 py-3 hover:bg-primary/90 transition-all duration-200 mt-6">
                        开始挑战
                    </a>
                </div>

                <!-- 数据库管理卡片 -->
                <div class="bg-white rounded-xl card-shadow p-6 transform transition-all duration-300 hover:shadow-lg flex flex-col h-full">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-secondary/10 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-database text-secondary text-xl"></i>
                        </div>
                        <h2 class="text-xl font-semibold text-gray-800">数据库管理</h2>
                    </div>
                    <p class="text-gray-600 flex-grow">管理单词组和查看错题集！</p>
                    <a href="database.html" class="block w-full bg-primary text-white text-center rounded-lg px-6 py-3 hover:bg-primary/90 transition-all duration-200 mt-6">
                        管理数据库
                    </a>
                </div>

                <!-- 豆包AI助手卡片 -->
                <div class="bg-white rounded-xl card-shadow p-6 transform transition-all duration-300 hover:shadow-lg flex flex-col h-full">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-success/10 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-robot text-success text-xl"></i>
                        </div>
                        <h2 class="text-xl font-semibold text-gray-800">豆包AI助手</h2>
                    </div>
                    <p class="text-gray-600 flex-grow">访问豆包AI助手，获取更多学习帮助和指导！</p>
                    <a href="https://www.doubao.com/chat/8026672275030018" target="_blank" class="block w-full bg-success text-white text-center rounded-lg px-6 py-3 hover:bg-success/90 transition-all duration-200 mt-6">
                        访问豆包
                    </a>
                </div>

                <!-- 闪卡学习卡片 -->
                <div class="bg-white rounded-xl card-shadow p-6 transform transition-all duration-300 hover:shadow-lg flex flex-col h-full">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-lightbulb-o text-primary text-xl"></i>
                        </div>
                        <h2 class="text-xl font-semibold text-gray-800">闪卡学习</h2>
                    </div>
                    <p class="text-gray-600 flex-grow">通过闪卡方式学习知识点，支持自定义内容和标签管理。</p>
                    <a href="flashcard.html" class="block w-full bg-primary text-white text-center rounded-lg px-6 py-3 hover:bg-primary/90 transition-all duration-200 mt-6">
                        开始学习
                    </a>
                </div>

                <!-- 通用选择题导入卡片 -->
                <div class="bg-white rounded-xl card-shadow p-6 transform transition-all duration-300 hover:shadow-lg flex flex-col h-full">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-success/10 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-list-alt text-success text-xl"></i>
                        </div>
                        <h2 class="text-xl font-semibold text-gray-800">通用选择题导入</h2>
                    </div>
                    <p class="text-gray-600 flex-grow">导入和管理选择题题库，支持批量导入和练习功能。</p>
                    <a href="choice-question.html" class="block w-full bg-success text-white text-center rounded-lg px-6 py-3 hover:bg-success/90 transition-all duration-200 mt-6">
                        开始使用
                    </a>
                </div>

                <!-- 使用说明卡片 -->
                <div class="bg-white rounded-xl card-shadow p-6 transform transition-all duration-300 hover:shadow-lg flex flex-col h-full">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-secondary/10 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-question-circle text-secondary text-xl"></i>
                        </div>
                        <h2 class="text-xl font-semibold text-gray-800">使用说明</h2>
                    </div>
                    <p class="text-gray-600 flex-grow">查看详细的使用指南、格式规范和AI提示词示例。</p>
                    <button onclick="showReadme()" class="block w-full bg-secondary text-white text-center rounded-lg px-6 py-3 hover:bg-secondary/90 transition-all duration-200 mt-6">
                        查看说明
                    </button>
                </div>

                <!-- 数据管理卡片 -->
                <div class="bg-white rounded-xl card-shadow p-6 transform transition-all duration-300 hover:shadow-lg flex flex-col h-full">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-danger/10 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-download text-danger text-xl"></i>
                        </div>
                        <h2 class="text-xl font-semibold text-gray-800">数据管理</h2>
                    </div>
                    <p class="text-gray-600 flex-grow">一键导出所有学习数据，或导入备份数据到其他设备。</p>
                    <button onclick="showDataManager()" class="block w-full bg-danger text-white text-center rounded-lg px-6 py-3 hover:bg-danger/90 transition-all duration-200 mt-6">
                        管理数据
                    </button>
                </div>

                <!-- GitHub仓库卡片 -->
                <div class="bg-white rounded-xl card-shadow p-6 transform transition-all duration-300 hover:shadow-lg flex flex-col h-full">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-gray-800/10 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-github text-gray-800 text-xl"></i>
                        </div>
                        <h2 class="text-xl font-semibold text-gray-800">GitHub仓库</h2>
                    </div>
                    <p class="text-gray-600 flex-grow">查看项目源代码、提交问题或贡献代码。</p>
                    <a href="https://github.com/qixiboss/duduenglish/tree/main" target="_blank" class="block w-full bg-gray-800 text-white text-center rounded-lg px-6 py-3 hover:bg-gray-900 transition-all duration-200 mt-6">
                        <i class="fa fa-external-link mr-2"></i>访问仓库
                    </a>
                </div>
            </div>
        </div>
    </main>

    <!-- README 查看模态框 -->
    <div id="readme-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl max-w-4xl w-full mx-4 max-h-[90vh] flex flex-col">
            <div class="p-6 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-semibold text-gray-800 flex items-center">
                        <i class="fa fa-book mr-2"></i>使用说明
                    </h3>
                    <button onclick="closeReadme()" class="text-gray-500 hover:text-gray-700">
                        <i class="fa fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            <div class="p-6 overflow-y-auto flex-grow">
                <div id="readme-content" class="prose prose-lg max-w-none">
                    <!-- README 内容将由JS动态加载 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 数据管理模态框 -->
    <div id="data-manager-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl max-w-2xl w-full mx-4 max-h-[90vh] flex flex-col">
            <div class="p-6 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-semibold text-gray-800 flex items-center">
                        <i class="fa fa-database mr-2"></i>数据管理
                    </h3>
                    <button onclick="closeDataManager()" class="text-gray-500 hover:text-gray-700">
                        <i class="fa fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            <div class="p-6 overflow-y-auto flex-grow">
                <div class="space-y-6">
                    <!-- 数据统计 -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-semibold text-gray-800 mb-3">当前数据统计</h4>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600">单词组数量：</span>
                                <span class="font-medium" id="word-groups-count">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">闪卡数量：</span>
                                <span class="font-medium" id="flashcards-count">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">选择题题库：</span>
                                <span class="font-medium" id="choice-questions-count">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">错题记录：</span>
                                <span class="font-medium" id="wrong-words-count">0</span>
                            </div>
                        </div>
                    </div>

                    <!-- 导出功能 -->
                    <div class="border border-gray-200 rounded-lg p-4">
                        <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                            <i class="fa fa-download mr-2 text-success"></i>导出数据
                        </h4>
                        <p class="text-sm text-gray-600 mb-4">导出所有学习数据为JSON文件，包含单词组、闪卡、选择题等。</p>
                        <button onclick="exportAllData()" class="w-full bg-success text-white rounded-lg px-4 py-2 hover:bg-success/90 transition-all duration-200">
                            <i class="fa fa-download mr-2"></i>一键导出所有数据
                        </button>
                    </div>

                    <!-- 导入功能 -->
                    <div class="border border-gray-200 rounded-lg p-4">
                        <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                            <i class="fa fa-upload mr-2 text-primary"></i>导入数据
                        </h4>
                        <p class="text-sm text-gray-600 mb-4">导入之前导出的数据文件，将合并到当前数据中。</p>
                        <div class="space-y-3">
                            <input type="file" id="import-file" accept=".json" class="hidden" onchange="handleFileSelect(event)">
                            <button onclick="document.getElementById('import-file').click()" class="w-full bg-primary text-white rounded-lg px-4 py-2 hover:bg-primary/90 transition-all duration-200">
                                <i class="fa fa-upload mr-2"></i>选择文件
                            </button>
                            <div id="import-preview" class="hidden">
                                <div class="bg-gray-50 rounded p-3">
                                    <h5 class="font-medium text-sm mb-2">文件预览：</h5>
                                    <div id="import-stats" class="text-xs text-gray-600 space-y-1"></div>
                                </div>
                                <button onclick="importAllData()" class="w-full bg-primary text-white rounded-lg px-4 py-2 hover:bg-primary/90 transition-all duration-200 mt-3">
                                    <i class="fa fa-check mr-2"></i>确认导入（将合并到现有数据）
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 注意事项 -->
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <h4 class="font-semibold text-yellow-800 mb-2 flex items-center">
                            <i class="fa fa-exclamation-triangle mr-2"></i>注意事项
                        </h4>
                        <ul class="text-sm text-yellow-700 space-y-1">
                            <li>• 导入数据将合并到当前数据中，不会覆盖现有数据</li>
                            <li>• 重复的数据项可能会被保留，请检查导入结果</li>
                            <li>• 数据仅存储在本地浏览器中，请定期备份</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-white py-4 border-t border-gray-200">
        <div class="container mx-auto px-4 text-center text-gray-500 text-sm">
            <p>英语学习助手 &copy; 2024 | 学习助手</p>
            <div class="mt-2">
                <a href="https://github.com/qixiboss/duduenglish/tree/main" target="_blank" class="text-gray-500 hover:text-gray-700 transition-colors duration-200">
                    <i class="fa fa-github mr-1"></i>GitHub仓库
                </a>
            </div>
        </div>
    </footer>

    <script>
        // 显示README内容
        async function showReadme() {
            try {
                const response = await fetch('README.md');
                const markdown = await response.text();
                const html = convertMarkdownToHtml(markdown);
                
                document.getElementById('readme-content').innerHTML = html;
                document.getElementById('readme-modal').classList.remove('hidden');
                document.getElementById('readme-modal').classList.add('flex');
            } catch (error) {
                console.error('加载README失败:', error);
                alert('加载使用说明失败，请检查网络连接');
            }
        }

        // 关闭README模态框
        function closeReadme() {
            document.getElementById('readme-modal').classList.add('hidden');
            document.getElementById('readme-modal').classList.remove('flex');
        }

        // 点击模态框外部关闭
        document.getElementById('readme-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeReadme();
            }
        });

        // 显示数据管理器
        function showDataManager() {
            updateDataStats();
            document.getElementById('data-manager-modal').classList.remove('hidden');
            document.getElementById('data-manager-modal').classList.add('flex');
        }

        // 关闭数据管理器
        function closeDataManager() {
            document.getElementById('data-manager-modal').classList.add('hidden');
            document.getElementById('data-manager-modal').classList.remove('flex');
            // 重置导入预览
            document.getElementById('import-preview').classList.add('hidden');
            document.getElementById('import-file').value = '';
        }

        // 点击模态框外部关闭
        document.getElementById('data-manager-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeDataManager();
            }
        });

        // 更新数据统计
        function updateDataStats() {
            const wordGroups = JSON.parse(localStorage.getItem('wordGroups') || '[]');
            const flashcards = JSON.parse(localStorage.getItem('flashcards') || '[]');
            const choiceQuestionBanks = JSON.parse(localStorage.getItem('choiceQuestionBanks') || '[]');
            const wrongWords = JSON.parse(localStorage.getItem('wrongWords') || '[]');

            document.getElementById('word-groups-count').textContent = wordGroups.length;
            document.getElementById('flashcards-count').textContent = flashcards.length;
            document.getElementById('choice-questions-count').textContent = choiceQuestionBanks.length;
            document.getElementById('wrong-words-count').textContent = wrongWords.length;
        }

        // 导出所有数据
        function exportAllData() {
            const exportData = {
                version: '1.0',
                exportTime: new Date().toISOString(),
                data: {
                    wordGroups: JSON.parse(localStorage.getItem('wordGroups') || '[]'),
                    flashcards: JSON.parse(localStorage.getItem('flashcards') || '[]'),
                    choiceQuestionBanks: JSON.parse(localStorage.getItem('choiceQuestionBanks') || '[]'),
                    wrongWords: JSON.parse(localStorage.getItem('wrongWords') || '[]'),
                    studyHistory: JSON.parse(localStorage.getItem('studyHistory') || '[]')
                }
            };

            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `english-learning-data-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);

            alert('数据导出成功！');
        }

        // 处理文件选择
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    showImportPreview(data);
                } catch (error) {
                    alert('文件格式错误，请选择正确的JSON文件！');
                    console.error('解析文件失败:', error);
                }
            };
            reader.readAsText(file);
        }

        // 显示导入预览
        function showImportPreview(data) {
            const statsDiv = document.getElementById('import-stats');
            let statsHtml = '';

            if (data.data) {
                const d = data.data;
                statsHtml += `<div>单词组：${d.wordGroups ? d.wordGroups.length : 0} 个</div>`;
                statsHtml += `<div>闪卡：${d.flashcards ? d.flashcards.length : 0} 张</div>`;
                statsHtml += `<div>选择题题库：${d.choiceQuestionBanks ? d.choiceQuestionBanks.length : 0} 个</div>`;
                statsHtml += `<div>错题记录：${d.wrongWords ? d.wrongWords.length : 0} 条</div>`;
                if (d.studyHistory) {
                    statsHtml += `<div>学习历史：${d.studyHistory.length} 条</div>`;
                }
            } else {
                statsHtml = '<div class="text-red-500">文件格式不正确</div>';
            }

            statsDiv.innerHTML = statsHtml;
            document.getElementById('import-preview').classList.remove('hidden');
        }

        // 导入所有数据
        function importAllData() {
            const file = document.getElementById('import-file').files[0];
            if (!file) {
                alert('请先选择文件！');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (!data.data) {
                        alert('文件格式不正确！');
                        return;
                    }

                    // 确认导入
                    if (!confirm('确定要导入数据吗？这将合并到当前所有数据！')) {
                        return;
                    }

                    // 合并数据而不是覆盖
                    if (data.data.wordGroups) {
                        const existingWordGroups = JSON.parse(localStorage.getItem('wordGroups') || '[]');
                        const newWordGroups = data.data.wordGroups;
                        // 使用ID去重，保留现有的
                        const existingIds = new Set(existingWordGroups.map(wg => wg.id));
                        const uniqueNewGroups = newWordGroups.filter(wg => !existingIds.has(wg.id));
                        const mergedWordGroups = [...existingWordGroups, ...uniqueNewGroups];
                        localStorage.setItem('wordGroups', JSON.stringify(mergedWordGroups));
                    }
                    
                    if (data.data.flashcards) {
                        const existingFlashcards = JSON.parse(localStorage.getItem('flashcards') || '[]');
                        const newFlashcards = data.data.flashcards;
                        // 使用ID去重，保留现有的
                        const existingIds = new Set(existingFlashcards.map(fc => fc.id));
                        const uniqueNewFlashcards = newFlashcards.filter(fc => !existingIds.has(fc.id));
                        const mergedFlashcards = [...existingFlashcards, ...uniqueNewFlashcards];
                        localStorage.setItem('flashcards', JSON.stringify(mergedFlashcards));
                    }
                    
                    if (data.data.choiceQuestionBanks) {
                        const existingBanks = JSON.parse(localStorage.getItem('choiceQuestionBanks') || '[]');
                        const newBanks = data.data.choiceQuestionBanks;
                        // 使用ID去重，保留现有的
                        const existingIds = new Set(existingBanks.map(bank => bank.id));
                        const uniqueNewBanks = newBanks.filter(bank => !existingIds.has(bank.id));
                        const mergedBanks = [...existingBanks, ...uniqueNewBanks];
                        localStorage.setItem('choiceQuestionBanks', JSON.stringify(mergedBanks));
                    }
                    
                    if (data.data.wrongWords) {
                        const existingWrongWords = JSON.parse(localStorage.getItem('wrongWords') || '[]');
                        const newWrongWords = data.data.wrongWords;
                        // 错题记录使用时间戳去重
                        const existingTimestamps = new Set(existingWrongWords.map(ww => ww.timestamp));
                        const uniqueNewWrongWords = newWrongWords.filter(ww => !existingTimestamps.has(ww.timestamp));
                        const mergedWrongWords = [...existingWrongWords, ...uniqueNewWrongWords];
                        localStorage.setItem('wrongWords', JSON.stringify(mergedWrongWords));
                    }
                    
                    if (data.data.studyHistory) {
                        const existingHistory = JSON.parse(localStorage.getItem('studyHistory') || '[]');
                        const newHistory = data.data.studyHistory;
                        // 学习历史使用sessionId去重
                        const existingSessionIds = new Set(existingHistory.map(h => h.sessionId));
                        const uniqueNewHistory = newHistory.filter(h => !existingSessionIds.has(h.sessionId));
                        const mergedHistory = [...existingHistory, ...uniqueNewHistory];
                        localStorage.setItem('studyHistory', JSON.stringify(mergedHistory));
                    }

                    alert('数据导入成功！页面将刷新以应用新数据。');
                    location.reload();
                } catch (error) {
                    alert('导入失败：' + error.message);
                    console.error('导入失败:', error);
                }
            };
            reader.readAsText(file);
        }

        // 简单的Markdown转HTML函数
        function convertMarkdownToHtml(markdown) {
            let html = markdown;
            
            // 处理标题
            html = html.replace(/^### (.*$)/gim, '<h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">$1</h3>');
            html = html.replace(/^## (.*$)/gim, '<h2 class="text-xl font-bold text-primary mt-8 mb-4 border-b border-gray-200 pb-2">$1</h2>');
            html = html.replace(/^# (.*$)/gim, '<h1 class="text-2xl font-bold text-primary mt-8 mb-6">$1</h1>');
            
            // 处理粗体
            html = html.replace(/\*\*(.*?)\*\*/g, '<strong class="font-semibold">$1</strong>');
            
            // 处理代码块
            html = html.replace(/```json\n([\s\S]*?)\n```/g, '<pre class="bg-gray-100 p-4 rounded-lg overflow-x-auto my-4"><code class="text-sm text-gray-800">$1</code></pre>');
            html = html.replace(/```js\n([\s\S]*?)\n```/g, '<pre class="bg-gray-100 p-4 rounded-lg overflow-x-auto my-4"><code class="text-sm text-gray-800">$1</code></pre>');
            html = html.replace(/```\n([\s\S]*?)\n```/g, '<pre class="bg-gray-100 p-4 rounded-lg overflow-x-auto my-4"><code class="text-sm text-gray-800">$1</code></pre>');
            
            // 处理行内代码
            html = html.replace(/`([^`]+)`/g, '<code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">$1</code>');
            
            // 处理列表
            html = html.replace(/^\d+\. (.*$)/gim, '<li class="ml-4">$1</li>');
            html = html.replace(/^- (.*$)/gim, '<li class="ml-4">$1</li>');
            
            // 包装列表
            html = html.replace(/(<li class="ml-4">.*<\/li>)/gs, '<ol class="list-decimal space-y-1 my-4">$1</ol>');
            
            // 处理段落
            html = html.replace(/\n\n/g, '</p><p class="my-4 text-gray-700 leading-relaxed">');
            html = html.replace(/^(?!<[h|p|o|u|pre])(.*$)/gim, '<p class="my-4 text-gray-700 leading-relaxed">$1</p>');
            
            // 处理分隔线
            html = html.replace(/^---$/gim, '<hr class="my-8 border-gray-200">');
            
            // 处理链接
            html = html.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" class="text-primary hover:underline" target="_blank">$1</a>');
            
            // 清理多余的段落标签
            html = html.replace(/<p class="my-4 text-gray-700 leading-relaxed"><\/p>/g, '');
            html = html.replace(/<p class="my-4 text-gray-700 leading-relaxed">(<[^>]+>.*<\/[^>]+>)<\/p>/g, '$1');
            
            return html;
        }
    </script>
</body>
</html> 